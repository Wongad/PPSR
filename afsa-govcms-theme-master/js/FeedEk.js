!function(e){e.fn.FeedEk=function(t){var a,i=e.extend({MaxCount:20,ShowDesc:!0,ShowPubDate:!0,DescCharacterLimit:0,DateFormat:"DD MMMM YYYY HH:mm",DateFormatLang:"en-gb"},t),n=e(this).attr("id"),s="";if(e("#"+n).empty(),void 0!=i.FeedUrl){e("#"+n).append('<div class="progress"><span style="width:100%;float:left;text-align:center;" class="filled">Loading information</span></div>');var r='SELECT channel.item FROM feednormalizer WHERE output="rss_2.0" AND url ="'+i.FeedUrl+'" LIMIT '+i.MaxCount;e.ajax({url:"https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent(r)+"&format=json&diagnostics=false&callback=?",dataType:"json",success:function(t){e("#"+n).empty(),t.query.results.rss instanceof Array||(t.query.results.rss=[t.query.results.rss]),e.each(t.query.results.rss,function(t,n){if(s+='<li><div class="itemTitle"><a href="'+n.channel.item.link+'" >'+n.channel.item.title+"</a></div>",i.ShowPubDate){if(a=new Date(n.channel.item.pubDate),s+='<div class="itemDate">',e.trim(i.DateFormat).length>0)try{moment.lang(i.DateFormatLang),s+=moment(a).format(i.DateFormat)}catch(t){s+=a.toLocaleDateString()}else s+=a.toLocaleDateString();s+="</div>"}i.ShowDesc&&(s+='<div class="itemContent">',s+=i.DescCharacterLimit>0&&n.channel.item.description.length>i.DescCharacterLimit?n.channel.item.description.substring(0,i.DescCharacterLimit)+"...":n.channel.item.description,s+="</div>")}),e("#"+n).append('<ul class="feedEkList">'+s+"</ul>")}})}}}(jQuery);
